---
title: "Airline Customer Satisfaction - Group 17"
output:
  html_document:
    toc: true
    toc_depth: 3
    number_sections: true
    toc_float: true
  pdf_document: default
date: "2025-03-27"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Project Background <a name="1"></a>

Lorem Ipsum

## Abstract <a name="1.1"></a>

**Framework for abstract:**

-   Introduction to airline industry

-   What the data is about

    -   customer satisfaction scores from 120,000+ passengers

    -   Nothing about the carrier

    -   Nothing about the price

-   What the research seeks to find

    -   Predict whether future customer would be satisfied given the details of service

    -   Determine the aspects of service that are important towards customer satisfaction

-   Methods of analysis

-   What the data tells us (findings)

**Draft of abstract:**

After industry-wide setbacks from the COVID-19 pandemic, the airline industry is experiencing a strong recovery in profitability. According to the International Air Transport Association (IATA), airlines worldwide have seen improved projections since 2024. The market is projected to showcase an annual growth rate (CAGR 2025-2029) of 4.36%, resulting in a projected market volume of US\$771.26bn by 2029, worldwide (Statista, 2024). However, low-cost carriers (LCCs) are shifting the traditional perceptions of value and service among travelers by offering lower fares with fewer amenities. As traditional full-service airlines compete in this market environment, understanding the main drivers of customer satisfaction becomes critical to maintain competitiveness.

In this research, we analyze data from over 120,000+ airline passengers, including information on passenger demographics, flight characteristics (delays and distance), as well as service evaluations. Since this data lacks information on the specific airlines and ticket pricing, we will focus on analyzing the service-related factors that universally impact passenger satisfaction. This research aims to:

1.  **Predict whether future customer would be satisfied given the details of service**
2.  **Determine the aspects of service that are important towards customer satisfaction**

In our analysis, we initially explore the dataset to understand the variables and their distributions, as well as detect missing values. Data preparation procedures such as cleaning, normalization, and transformation are conducted before analysis. We utilize Principal Component Analysis (PCA) to reduce dimensionality as well as to determine key variables. Clustering is then implemented to gain deeper insights on passenger groups and patterns of service satisfaction.**\<- placeholder aja, bisa diubah**

In summary.... **(hasil temuan)**

## Business Problem <a name="1.2"></a>

In this project, Group 17 serves as business consultants, with a focus on improving customer experience in the industry. Our responsibilities are from analyzing customer satisfaction statistics, developing measures to improve the airline's overall performance. Therefore, the business problem that we solve is "how the airline can improve its strategy of services and activities to significantly increase customer satisfaction, especially between segments and main service areas, thus promoting customer loyalty and achieving stronger competitive advantages?". 

**The reason why we chose airline industry as our focus :**

* We provide comprehensive data from Kaggle across various aspects of the flying experience which allows us to in-depth analysis.  

* Intense rivalry airline industry has intense competition among company, and it could be easily justified by customer satisfaction. Thus, higher customer satisfaction leads to increased client retention and overall business performance.   

* Concentrating on major market segments may be an efficient technique for improving overall consumer satisfaction. 

**Why focus on customer satisfaction?** 

Enhance customer loyalty: improving on these key segments and service areas will enhance customer satisfaction that potentially increases customer loyalty rate. 

Competitive Advantage: by addressing the service issue, the airline can stand out from the competitors.

## Setting Up the R Workplace <a name="1.3"></a>

Lorem IpsumBesides the Basic R Functions, this  project uses multiple packages to enhance the R functionalities and improve the data analytics and visualization quality. This section explains all the packages and functions beyond the Basic R functionalities that we are using in this project in each step of the business analytics process from data cleaning to modeling.

* Data Cleaning

**dplyr** : used to filter rows, select columns, sort data, create new columns, and summarize data.

* Data Exploration

**skimr** : designed to provide summary of statistical measures for each variables in data frames.
**DataExplorer** : used to display comprehensive and convenient interface for data exploration and data visualization.

* Data Preparation

* Data Transformation

* Data Visualization

**ggplot2** : a package that is useful to visualize data in a more complex and customizable way compared to the basic R plotting functions.

* Data Modeling

* Data Analysis

Below we will find the commands to install and import the required libraries:

```{r}
# Importing Library

library(dplyr)
library(ggplot2)
library(skimr)
library(DataExplorer)
library(corrplot)
library(tidyr)
```

## Dataset <a name="1.4"></a>

In this assignment, we use data set of [Airline Passenger Satisfaction Dataset](https://www.kaggle.com/datasets/mysarahmadbhat/airline-passenger-satisfaction) through Kaggle.The data consist of 24 variables from 129,880 passengers. Data cleaning and preparation are required to ensure the data is ready for analysis.

Firstly import all the data, csv file to be used in the data analysis process. The before using the data, it is important to undertand all data type included in the data set.Subsequently, understanding statistic perofile in the data set could help to prepare the data before using it.

```{r}
# Read Data
# please note that the csv needs to be put into the same folders as this file for ensuring everything works properly
# the dataset should be downloaded from the Kaggle, or unzip from our submission in BrightSpace.
data <- read.csv("airline_passenger_satisfaction.csv")

#Understanding the data types
str(data)
```

```{r}
# Summary of Data statistics
summary(data)
```

### Data Dictionary
Based on Kaggle, here is the definition of each column in the dataset. This is useful for later stage to understand the data characteristics and how to use it.


<style>
  table {
    width: 100%;
    border-collapse: collapse;
  }
  th {
    background-color: #87CEEB; /* Sky blue header */
    color: white;
    text-align: left;
    padding: 8px;
  }
  td {
    padding: 8px;
    text-align: left;
  }
  th, td {
    border: 1px solid #ddd;
  }
  th:first-child, td:first-child {
    width: 200px; /* Adjust field name column width */
  }
  th:last-child, td:last-child {
    width: 600px; /* Adjust description column width */
  }
</style>

| **Field Name**  | **Description**  |
|----------------|----------------|
| **ID** | Unique passenger identifier |
| **Gender** | Gender of the passenger (Female/Male) |
| **Age** | Age of the passenger |
| **Customer Type** | Type of airline customer (First-time/Returning) |
| **Type of Travel** | Purpose of the flight (Business/Personal) |
| **Class** | Travel class in the airplane for the passenger seat |
| **Flight Distance** | Flight distance in miles |
| **Departure Delay** | Flight departure delay in minutes |
| **Arrival Delay** | Flight arrival delay in minutes |
| **Departure and Arrival Time Convenience** | Satisfaction level with the convenience of the flight departure and arrival times from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **Ease of Online Booking** | Satisfaction level with the online booking experience from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **Check-in Service** | Satisfaction level with the check-in service from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **Online Boarding** | Satisfaction level with the online boarding experience from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **Gate Location** | Satisfaction level with the gate location in the airport from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **On-board Service** | Satisfaction level with the on-boarding service in the airport from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **Seat Comfort** | Satisfaction level with the comfort of the airplane seat from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **Leg Room Service** | Satisfaction level with the leg room of the airplane seat from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **Cleanliness** | Satisfaction level with the cleanliness of the airplane from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **Food and Drink** | Satisfaction level with the food and drinks on the airplane from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **In-flight Service** | Satisfaction level with the in-flight service from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **In-flight Wifi Service** | Satisfaction level with the in-flight Wifi service from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **In-flight Entertainment** | Satisfaction level with the in-flight entertainment from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **Baggage Handling** | Satisfaction level with the baggage handling from the airline from 1 (lowest) to 5 (highest) - 0 means "not applicable" |
| **Satisfaction** | Overall satisfaction level with the airline (Satisfied/Neutral or unsatisfied) | 


## Workflow: Machine-Learning Task Translation <a name="1.5"></a>

The business analysis focuses on what key parameters from passengers' perspective that define their satisfactory level towards airline services. The analysis will be conducted by perfroming predictive modelling (regression analysis) as well as classification. Run code belows to see the workflow of the analysis.

```{r}
file_path <- "Workflow_Group17.png"
knitr::include_graphics(file_path)
```

## Reflection and Limitation <a name="1.6"></a>

In this research, we aim to predict **whether future customer would be satisfied given the details of service** by determining **the aspects of service that are important towards customer satisfaction.** From the dataset, we hypothesize that service characteristics such as arrival and departure delays, on-board service, and comfort play a significant role towards customer satisfaction.

Given that the dataset does not provide information on the specific airline or ticket pricing, we will focus to analyzing the service-related factors that universally impact passenger satisfaction. Understanding and preparing the the dataset will be crucial, as it may contain missing values or quality issues. Hence, we will dedicate the next section on data exploration and preparation. In doing so, we will first visualize the variables to get an understanding of the distributions.

# Data Exploration and Preparation <a name="2"></a>

Lorem Ipsum

## Data Cleaning and Preparation <a name="2.1"></a>

Lorem Ipsum

```{r}
any(is.na(data))
colMeans(is.na(data))
```

Null only exist for 0.3% and only in column Arrival Delay, therefore this would not significantly affecting the whole dataset. We'll fill the Arrival Delay null with mean and median of Arrival Delay whic is 0.

```{r}
data$Departure.Delay = as.numeric(data$Departure.Delay)
data$Arrival.Delay[is.na(data$Arrival.Delay)] <-0
any(is.na(data))
```

We succesfully eliminate null value in the dataset.

Lorem Ipsum 

We notice that there is some outliers in the Arrival Delay, Departure Delay, and the Flight Distance. Let's see in the boxplot format :

Flight Distance

```{r}
ggplot(data, aes(x=Flight.Distance)) +
geom_boxplot(fill = 2,alpha = 0.5,color = 1,outlier.colour = 2) +
theme_bw()
```

Departure Delay :

```{r}
ggplot(data, aes(x=Departure.Delay)) +
geom_boxplot(fill = 2,alpha = 0.5,color = 1,outlier.colour = 2) +
theme_bw()
```

Arrival Delay :

```{r}
ggplot(data, aes(x=Arrival.Delay)) +
geom_boxplot(fill = 2,alpha = 0.5,color = 1,outlier.colour = 2) +
theme_bw()
```

Median imputation is appropriate when the distribution of the data is skewed.

```{r}
data$Flight.Distance[which(
  data$Flight.Distance > (quantile(data$Flight.Distance, 0.75, na.rm = TRUE) + 1.5 * IQR(data$Flight.Distance, na.rm = TRUE))
)] <- median(data$Flight.Distance, na.rm = TRUE)

data$Arrival.Delay[which(
  data$Arrival.Delay > (quantile(data$Arrival.Delay, 0.75, na.rm = TRUE) + 1.5 * IQR(data$Arrival.Delay, na.rm = TRUE))
)] <- median(data$Arrival.Delay, na.rm = TRUE)

data$Departure.Delay[which(
  data$Departure.Delay > (quantile(data$Departure.Delay, 0.75, na.rm = TRUE) + 1.5 * IQR(data$Departure.Delay, na.rm = TRUE))
)] <- median(data$Departure.Delay, na.rm = TRUE)
```

Now we can see the distribution of the data after the imputation.

```{r}
plot_histogram(data[ , c('Flight.Distance','Arrival.Delay','Departure.Delay')], ncol=2,ggtheme = theme_minimal())
```

```{r}
ggplot(data, aes(x=Departure.Delay)) +
geom_boxplot(fill = 2,alpha = 0.5,color = 1,outlier.colour = 2) +
theme_bw()
```
```{r}
ggplot(data, aes(x=Arrival.Delay)) +
geom_boxplot(fill = 2,alpha = 0.5,color = 1,outlier.colour = 2) +
theme_bw()
```

Lorem Ipsum

## Data Exploration <a name="2.2"></a>

Lorem Ipsum

### Univariate Data Analysis

Now we visualize the distribution in each categorical column

```{r}
plot_bar(data, ncol=2, order_bar=TRUE, ggtheme = theme_minimal())
```

We can notice that the gender distribution is equal. The type of travel is focusing on business with most of the customer are the returning customer rather than the first time. We can notice that focus in increasing satisfaction of loyal customer will bring significant impact to the overall of airline customer satisfaction rate.

Next we will visualize the distribution in each numerical column

```{r}
plot_histogram(data, ncol=2,ggtheme = theme_minimal())
```

### Association Between Two Numerical Variable

```{r corrplot, fig.width=14, fig.height=12}
numeric_data <- data[sapply(data, is.numeric)]
numeric_data <- na.omit(numeric_data)

# Compute correlation matrix
cor_matrix <- cor(numeric_data)

# Print the correlation matrix
print(cor_matrix)

# Visualize the correlation matrix
options(repr.plot.width=14, repr.plot.height=12)
corrplot(cor_matrix,
         method = "color",
         type = "upper",
         order = "hclust",
         tl.col = "black",
         tl.cex = 0.8,
         number.cex = 0.7,
         addCoef.col = "black",
         diag = FALSE)
```

Lorem Ipsum

```{r}
# Discover strong correlation
cor_matrix_flat <- as.data.frame(as.table(cor_matrix))
filtered <- subset(cor_matrix_flat, abs(Freq) > 0.5 & Var1 != Var2)
filtered <- filtered[!duplicated(t(apply(filtered[, 1:2], 1, sort))), ]

print(filtered)
```

In-flight comfort and service such as Seat Comfort, Leg Room Service, Cleanliness, Food and Drink, In-flight Service, In-flight Wifi Service, and In-flight Entertainment are highly correlated with each other. This is expected as they are all related to the comfort and service provided during the flight.

Digital service such as Ease of Online Booking, Online Boarding, and In-flight Wifi Service are also highly correlated with each other. This is expected as they are all related to the digital service provided by the airline.

```{r}
count_data <- as.data.frame(table(data$In.flight.Service, data$On.board.Service))
count_data$Percent <- round(100 * count_data$Freq / sum(count_data$Freq), 1)

# Plot heatmap
ggplot(count_data, aes(x = Var1, y = Var2, fill = Percent)) +
  geom_tile(color = "white") +
  geom_text(aes(label = paste0(Percent, "%")), color = "black", size = 3) +
  scale_fill_gradient(low = "lightyellow", high = "darkred") +
  labs(title = "In-flight Service vs On-board Service (in %)",
       x = "In-flight Service Rating",
       y = "On-board Service Rating",
       fill = "Percentage") +
  theme_minimal()
```

Lorem Ipsum

```{r}
count_data <- as.data.frame(table(data$In.flight.Entertainment, data$Food.and.Drink))
count_data$Percent <- round(100 * count_data$Freq / sum(count_data$Freq), 1)

# Plot heatmap
ggplot(count_data, aes(x = Var1, y = Var2, fill = Percent)) +
  geom_tile(color = "white") +
  geom_text(aes(label = paste0(Percent, "%")), color = "black", size = 3) +
  scale_fill_gradient(low = "lightyellow", high = "darkred") +
  labs(title = "In-flight Entertainment vs Food and Drink (in %)",
       x = "In-flight Entertainment Rating",
       y = "Food and Drink Rating",
       fill = "Percentage") +
  theme_minimal()
```

Lorem Ipsum

```{r}
count_data <- as.data.frame(table(data$In.flight.Entertainment, data$Cleanliness))
count_data$Percent <- round(100 * count_data$Freq / sum(count_data$Freq), 1)

# Plot heatmap
ggplot(count_data, aes(x = Var1, y = Var2, fill = Percent)) +
  geom_tile(color = "white") +
  geom_text(aes(label = paste0(Percent, "%")), color = "black", size = 3) +
  scale_fill_gradient(low = "lightyellow", high = "darkred") +
  labs(title = "In-flight Entertainment vs Cleanliness (in %)",
       x = "In-flight Entertainment Rating",
       y = "Cleanliness Rating",
       fill = "Percentage") +
  theme_minimal()
```

Lorem Ipsum 


```{r}
count_data <- as.data.frame(table(data$In.flight.Entertainment, data$Seat.Comfort))
count_data$Percent <- round(100 * count_data$Freq / sum(count_data$Freq), 1)

# Plot heatmap
ggplot(count_data, aes(x = Var1, y = Var2, fill = Percent)) +
  geom_tile(color = "white") +
  geom_text(aes(label = paste0(Percent, "%")), color = "black", size = 3) +
  scale_fill_gradient(low = "lightyellow", high = "darkred") +
  labs(title = "In-flight Entertainment vs Seat Comfort (in %)",
       x = "In-flight Entertainment Rating",
       y = "Seat Comfort Rating",
       fill = "Percentage") +
  theme_minimal()
```

Lorem Ipsum 

```{r}
count_data <- as.data.frame(table(data$Food.and.Drink, data$Cleanliness))
count_data$Percent <- round(100 * count_data$Freq / sum(count_data$Freq), 1)

# Plot heatmap
ggplot(count_data, aes(x = Var1, y = Var2, fill = Percent)) +
  geom_tile(color = "white") +
  geom_text(aes(label = paste0(Percent, "%")), color = "black", size = 3) +
  scale_fill_gradient(low = "lightyellow", high = "darkred") +
  labs(title = "Food and Drink vs Cleanliness (in %)",
       x = "Food and Drink Rating",
       y = "Cleanliness Rating",
       fill = "Percentage") +
  theme_minimal()
```

Lorem Ipsum 

```{r}
count_data <- as.data.frame(table(data$Food.and.Drink, data$Seat.Comfort))
count_data$Percent <- round(100 * count_data$Freq / sum(count_data$Freq), 1)

# Plot heatmap
ggplot(count_data, aes(x = Var1, y = Var2, fill = Percent)) +
  geom_tile(color = "white") +
  geom_text(aes(label = paste0(Percent, "%")), color = "black", size = 3) +
  scale_fill_gradient(low = "lightyellow", high = "darkred") +
  labs(title = "Food and Drink vs Seat Comfort (in %)",
       x = "Food and Drink Rating",
       y = "Seat Comfort Rating",
       fill = "Percentage") +
  theme_minimal()
```

Lorem Ipsum 

```{r}
count_data <- as.data.frame(table(data$Cleanliness, data$Seat.Comfort))
count_data$Percent <- round(100 * count_data$Freq / sum(count_data$Freq), 1)

# Plot heatmap
ggplot(count_data, aes(x = Var1, y = Var2, fill = Percent)) +
  geom_tile(color = "white") +
  geom_text(aes(label = paste0(Percent, "%")), color = "black", size = 3) +
  scale_fill_gradient(low = "lightyellow", high = "darkred") +
  labs(title = "Cleanliness vs Seat Comfort (in %)",
       x = "Cleanliness Rating",
       y = "Seat Comfort Rating",
       fill = "Percentage") +
  theme_minimal()
```

Lorem Ipsum 

```{r}
count_data <- as.data.frame(table(data$In.flight.Wifi.Service, data$Ease.of.Online.Booking))
count_data$Percent <- round(100 * count_data$Freq / sum(count_data$Freq), 1)

# Plot heatmap
ggplot(count_data, aes(x = Var1, y = Var2, fill = Percent)) +
  geom_tile(color = "white") +
  geom_text(aes(label = paste0(Percent, "%")), color = "black", size = 3) +
  scale_fill_gradient(low = "lightyellow", high = "darkred") +
  labs(title = "In-Flight Wifi Service vs Ease of Online Booking (in %)",
       x = "In-Flight Wifi Service Rating",
       y = "Ease of Online Booking Rating",
       fill = "Percentage") +
  theme_minimal()
```

Lorem Ipsum 

```{r}
ggplot(data, aes(x = Flight.Distance, y = Departure.Delay)) +
  geom_point(alpha = 0.2, color = "steelblue", size = 1.5) +
  labs(title = "Flight Distance vs Departure Delay",
       x = "Flight Distance",
       y = "Departure Delay") +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
  theme_minimal()
```

Lorem Ipsum 

```{r}
ggplot(data, aes(x = Flight.Distance, y = Arrival.Delay)) +
  geom_point(alpha = 0.2, color = "steelblue", size = 1.5) +
  labs(title = "Flight Distance vs Arrival Delay",
       x = "Flight Distance",
       y = "Arrival Delay") +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
  theme_minimal()
```

### Association Between Numerical and Categorical Variable

Lorem ipsum

```{r}
data_subset <- data %>%
  select(Satisfaction, Age, Flight.Distance, Departure.Delay,
         Arrival.Delay)

# Convert to long format for faceting
data_long <- pivot_longer(data_subset, -Satisfaction, names_to = "Variable", values_to = "Value")

# Plot boxplots with facets
ggplot(data_long, aes(x = Satisfaction, y = Value, fill = Satisfaction)) +
  geom_boxplot() +
  facet_wrap(~ Variable, scales = "free_y") +
  theme_minimal() +
  labs(title = "Boxplots of Numeric Variables by Satisfaction",
       x = NULL, y = NULL) +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "none"
  )
```

Lorem Ipsum


```{r}
data_subset <- data %>%
  select(Satisfaction, Ease.of.Online.Booking, Check.in.Service, Online.Boarding,
         Gate.Location, On.board.Service, Leg.Room.Service, Flight.Distance)

# Convert to long format
data_long <- pivot_longer(data_subset, -Satisfaction, names_to = "Variable", values_to = "Value")

# Create faceted histogram
ggplot(data_long, aes(x = Value, fill = Satisfaction)) +
  geom_histogram(position = "stack", alpha = 0.5, bins = 30) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  theme_minimal() +
  labs(title = "Histograms of Numeric Variables by Satisfaction",
       x = NULL, y = "Count") +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "bottom"
  )
```

```{r}
data_subset <- data %>%
  select(Satisfaction, Seat.Comfort, In.flight.Service, Baggage.Handling,
         In.flight.Entertainment, In.flight.Wifi.Service, Food.and.Drink, Cleanliness)

# Convert to long format
data_long <- pivot_longer(data_subset, -Satisfaction, names_to = "Variable", values_to = "Value")

# Create faceted histogram
ggplot(data_long, aes(x = Value, fill = Satisfaction)) +
  geom_histogram(position = "stack", alpha = 0.5, bins = 30) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  theme_minimal() +
  labs(title = "Histograms of Numeric Variables by Satisfaction",
       x = NULL, y = "Count") +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "bottom"
  )
```

Lorem Ipsum

```{r}
data_subset <- data %>%
  select(Class, Age, Flight.Distance, Departure.Delay,
         Arrival.Delay)

# Convert to long format for faceting
data_long <- pivot_longer(data_subset, -Class, names_to = "Variable", values_to = "Value")

# Plot boxplots with facets
ggplot(data_long, aes(x = Class, y = Value, fill = Class)) +
  geom_boxplot() +
  facet_wrap(~ Variable, scales = "free_y") +
  theme_minimal() +
  labs(title = "Boxplots of Numeric Variables by Class",
       x = NULL, y = NULL) +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "none"
  )
```

Lorem Ipsum

```{r}
data_subset <- data %>%
  select(Class, Ease.of.Online.Booking, Check.in.Service, Online.Boarding,
         Gate.Location, On.board.Service, Leg.Room.Service, Flight.Distance)

# Convert to long format
data_long <- pivot_longer(data_subset, -Class, names_to = "Variable", values_to = "Value")

# Create faceted histogram
ggplot(data_long, aes(x = Value, fill = Class)) +
  geom_histogram(position = "stack", alpha = 0.5, bins = 30) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  theme_minimal() +
  labs(title = "Histograms of Numeric Variables by Class",
       x = NULL, y = "Count") +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "bottom"
  )
```

```{r}
data_subset <- data %>%
  select(Class, Seat.Comfort, In.flight.Service, Baggage.Handling,
         In.flight.Entertainment, In.flight.Wifi.Service, Food.and.Drink, Cleanliness)

# Convert to long format
data_long <- pivot_longer(data_subset, -Class, names_to = "Variable", values_to = "Value")

# Create faceted histogram
ggplot(data_long, aes(x = Value, fill = Class)) +
  geom_histogram(position = "stack", alpha = 0.5, bins = 30) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  theme_minimal() +
  labs(title = "Histograms of Numeric Variables by Class",
       x = NULL, y = "Count") +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "bottom"
  )
```

Lorem Ipsum

```{r}
data_subset <- data %>%
  select(Type.of.Travel, Age, Flight.Distance, Departure.Delay,
         Arrival.Delay)

# Convert to long format for faceting
data_long <- pivot_longer(data_subset, -Type.of.Travel, names_to = "Variable", values_to = "Value")

# Plot boxplots with facets
ggplot(data_long, aes(x = Type.of.Travel, y = Value, fill = Type.of.Travel)) +
  geom_boxplot() +
  facet_wrap(~ Variable, scales = "free_y") +
  theme_minimal() +
  labs(title = "Boxplots of Numeric Variables by Type of Travel",
       x = NULL, y = NULL) +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "none"
  )
```

Lorem Ipsum

```{r}
data_subset <- data %>%
  select(Type.of.Travel, Ease.of.Online.Booking, Check.in.Service, Online.Boarding,
         Gate.Location, On.board.Service, Leg.Room.Service, Flight.Distance)

# Convert to long format
data_long <- pivot_longer(data_subset, -Type.of.Travel, names_to = "Variable", values_to = "Value")

# Create faceted histogram
ggplot(data_long, aes(x = Value, fill = Type.of.Travel)) +
  geom_histogram(position = "stack", alpha = 0.5, bins = 30) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  theme_minimal() +
  labs(title = "Histograms of Numeric Variables by Type of Travel",
       x = NULL, y = "Count") +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "bottom"
  )
```

```{r}
data_subset <- data %>%
  select(Type.of.Travel, Seat.Comfort, In.flight.Service, Baggage.Handling,
         In.flight.Entertainment, In.flight.Wifi.Service, Food.and.Drink, Cleanliness)

# Convert to long format
data_long <- pivot_longer(data_subset, -Type.of.Travel, names_to = "Variable", values_to = "Value")

# Create faceted histogram
ggplot(data_long, aes(x = Value, fill = Type.of.Travel)) +
  geom_histogram(position = "stack", alpha = 0.5, bins = 30) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  theme_minimal() +
  labs(title = "Histograms of Numeric Variables by Type of Travel",
       x = NULL, y = "Count") +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "bottom"
  )
```

Lorem Ipsum

```{r}
data_subset <- data %>%
  select(Gender, Age, Flight.Distance, Departure.Delay,
         Arrival.Delay)

# Convert to long format for faceting
data_long <- pivot_longer(data_subset, -Gender, names_to = "Variable", values_to = "Value")

# Plot boxplots with facets
ggplot(data_long, aes(x = Gender, y = Value, fill = Gender)) +
  geom_boxplot() +
  facet_wrap(~ Variable, scales = "free_y") +
  theme_minimal() +
  labs(title = "Boxplots of Numeric Variables by Gender",
       x = NULL, y = NULL) +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "none"
  )
```

Lorem Ipsum

```{r}
data_subset <- data %>%
  select(Gender, Ease.of.Online.Booking, Check.in.Service, Online.Boarding,
         Gate.Location, On.board.Service, Leg.Room.Service, Flight.Distance)

# Convert to long format
data_long <- pivot_longer(data_subset, -Gender, names_to = "Variable", values_to = "Value")

# Create faceted histogram
ggplot(data_long, aes(x = Value, fill = Gender)) +
  geom_histogram(position = "stack", alpha = 0.5, bins = 30) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  theme_minimal() +
  labs(title = "Histograms of Numeric Variables by Gender",
       x = NULL, y = "Count") +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "bottom"
  )
```

```{r}
data_subset <- data %>%
  select(Gender, Seat.Comfort, In.flight.Service, Baggage.Handling,
         In.flight.Entertainment, In.flight.Wifi.Service, Food.and.Drink, Cleanliness)

# Convert to long format
data_long <- pivot_longer(data_subset, -Gender, names_to = "Variable", values_to = "Value")

# Create faceted histogram
ggplot(data_long, aes(x = Value, fill = Gender)) +
  geom_histogram(position = "stack", alpha = 0.5, bins = 30) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  theme_minimal() +
  labs(title = "Histograms of Numeric Variables by Gender",
       x = NULL, y = "Count") +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "bottom"
  )
```

Lorem Ipsum

```{r}
data_subset <- data %>%
  select(Customer.Type, Age, Flight.Distance, Departure.Delay,
         Arrival.Delay)

# Convert to long format for faceting
data_long <- pivot_longer(data_subset, -Customer.Type, names_to = "Variable", values_to = "Value")

# Plot boxplots with facets
ggplot(data_long, aes(x = Customer.Type, y = Value, fill = Customer.Type)) +
  geom_boxplot() +
  facet_wrap(~ Variable, scales = "free_y") +
  theme_minimal() +
  labs(title = "Boxplots of Numeric Variables by Customer Type",
       x = NULL, y = NULL) +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "none"
  )
```

Lorem Ipsum

```{r}
data_subset <- data %>%
  select(Customer.Type, Ease.of.Online.Booking, Check.in.Service, Online.Boarding,
         Gate.Location, On.board.Service, Leg.Room.Service, Flight.Distance)

# Convert to long format
data_long <- pivot_longer(data_subset, -Customer.Type, names_to = "Variable", values_to = "Value")

# Create faceted histogram
ggplot(data_long, aes(x = Value, fill = Customer.Type)) +
  geom_histogram(position = "stack", alpha = 0.5, bins = 30) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  theme_minimal() +
  labs(title = "Histograms of Numeric Variables by Customer Type",
       x = NULL, y = "Count") +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "bottom"
  )
```

```{r}
data_subset <- data %>%
  select(Customer.Type, Seat.Comfort, In.flight.Service, Baggage.Handling,
         In.flight.Entertainment, In.flight.Wifi.Service, Food.and.Drink, Cleanliness)

# Convert to long format
data_long <- pivot_longer(data_subset, -Customer.Type, names_to = "Variable", values_to = "Value")

# Create faceted histogram
ggplot(data_long, aes(x = Value, fill = Customer.Type)) +
  geom_histogram(position = "stack", alpha = 0.5, bins = 30) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  theme_minimal() +
  labs(title = "Histograms of Numeric Variables by Customer Type",
       x = NULL, y = "Count") +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "bottom"
  )
```

Lorem Ipsum

### Association Between Two Categorical Variable

```{r}
plot_bar(data,ncol=2)
```

Lorem ipsum

```{r}
plot_bar(data,by='Satisfaction',ncol=2)
```

Lorem ipsum

```{r}
plot_bar(data,by='Gender',ncol=2)
```

Lorem ipsum

```{r}
plot_bar(data,by='Customer.Type',ncol=2)
```

Lorem ipsum

```{r}
plot_bar(data,by='Type.of.Travel',ncol=2)
```

Lorem ipsum

```{r}
plot_bar(data,by='Class',ncol=2)
```

Lorem ipsum

## Feature Engineering <a name="2.3"></a>

We notice that the age distribution have high variation, therefore we try to create the age_group column

```{r}
data = data %>% mutate(Age_Range = if_else(Age <= 16,"Children",
if_else(17 <= Age & Age <= 30,"Youth",
if_else(30 < Age & Age <= 45,"Middle Aged","Old"))))
```

```{r}
plot_bar(data$Age_Range,ncol=2,order_bar=T,ggtheme = theme_minimal())
```

Now we can interpret from the age group that the largest segment of our customer is belong to old age group which is >45 years old.

Another data we can group is the flight distance which currently right skewed

```{r}
data = data %>% mutate(Distance_Group = if_else(Flight.Distance < 1000,"Below 1000",
if_else(1000 <= Flight.Distance & Flight.Distance <= 2000,"1000-2000",
if_else(2000 < Flight.Distance & Flight.Distance < 3000,"2000-3000",
if_else(3000 < Flight.Distance & Flight.Distance < 4000,"3000-4000","Above 4000")))))
```

```{r}
plot_bar(data$Distance_Group,ncol=2,order_bar=T,ggtheme = theme_minimal())
```

We can divide which customer experiencing delay or not based on departure delay and arrival delay

```{r}
data$delay.status = ifelse(data$Departure.Delay > 0 | data$Arrival.Delay > 0, "Delayed", "On Time")

plot_bar(data$delay.status,ncol=2,order_bar=T,ggtheme = theme_minimal())
```

We'll try to grouping the features into category of services that could be improved by the airline :

Flight General services : Food and Drink, In-flight Service
Flight Experience : In Flight Wifi Service, In Flight Entertainment
Digital services : Ease of Online Booking, Online Boarding
Comfort services : Seat Comfort, Leg Room Service, Cleanliness


```{r}
data$Flight.Service = rowSums(data[,c('Food.and.Drink','In.flight.Service')],na.rm = TRUE)
data$Flight.Entertainment = rowSums(data[,c('In.flight.Wifi.Service','In.flight.Entertainment')],na.rm = TRUE)
data$Digital.Service = rowSums(data[,c('Ease.of.Online.Booking','Online.Boarding')],na.rm = TRUE)
data$Comfort.Service = rowSums(data[,c('Seat.Comfort','Leg.Room.Service','Cleanliness')],na.rm = TRUE)

plot_histogram(data[ , c("Flight.Service", "Flight.Entertainment", "Digital.Service", "Comfort.Service")], ncol=2,ggtheme = theme_minimal())
```

Lorem Ipsum

## Data Tranformation <a name="2.4"></a>

```{r}
plot_histogram(data, ncol=2,ggtheme = theme_minimal())
```

We can see that the data is not normally distributed, therefore we need to normalize the data.

```{r}
data$Departure.Delay.Duration = ifelse(data$Departure.Delay > 0, data$Departure.Delay, NA)
data$Arrival.Delay.Duration = ifelse(data$Arrival.Delay > 0, data$Arrival.Delay, NA)

data$Flight.Distance.log = log(1 + data$Flight.Distance)
data$Age.log = log(1 + data$Age)
data$Departure.Delay.Duration.log = log(1 + data$Departure.Delay.Duration)
data$Arrival.Delay.Duration.log = log(1 + data$Arrival.Delay.Duration)

plot_histogram(data[, c("Flight.Distance.log", "Age.log", "Departure.Delay.Duration.log", "Arrival.Delay.Duration.log")], ncol=2,ggtheme = theme_minimal())
```

We can see that the data is now normally distributed. Now we need to normalize the data to have the same scale.

```{r}
data$Flight.Distance.log.z = scale(data$Flight.Distance.log)
data$Age.log.z = scale(data$Age.log)
data$Departure.Delay.Duration.log.z = scale(data$Departure.Delay.Duration.log)
data$Arrival.Delay.Duration.log.z = scale(data$Arrival.Delay.Duration.log)

plot_histogram(data[, c("Flight.Distance.log.z", "Age.log.z", "Departure.Delay.Duration.log.z", "Arrival.Delay.Duration.log.z")], ncol=2,ggtheme = theme_minimal())
```

Lorem Ipsum

## Initial Plotting <a name="2.5"></a>

Our target is the satisfaction rate of the airlines services, therefore we need to identified how each variable are correlated to the satisfaction

```{r}
plot_bar(data,by='Satisfaction',ncol=2)
```

Satisfaction for new features :

```{r}
data_subset <- data %>%
  select(Satisfaction, Flight.Service, Flight.Entertainment, Digital.Service, Comfort.Service)

# Convert to long format
data_long <- pivot_longer(data_subset, -Satisfaction, names_to = "Variable", values_to = "Value")

# Create faceted histogram
ggplot(data_long, aes(x = Value, fill = Satisfaction)) +
  geom_histogram(position = "stack", alpha = 0.5, bins = 30) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  theme_minimal() +
  labs(title = "Histograms of New Numeric Variables by Satisfaction",
       x = NULL, y = "Count") +
  theme(
    strip.text = element_text(size = 12),
    legend.position = "bottom"
  )
```

Lorem Ipsum

```{r}
data %>% group_by(Class, Satisfaction) %>% summarize(num=n()) %>% mutate(percentage=round(num*100/sum(num),2))
```

We notice that economy class passenger is having high customer base but with high percentage of dissatisfied customer rate. Therefore targeting this customer base for services improvement will highly affecting airline overall satisfaction rate.

```{r}
data %>% group_by(Type.of.Travel, Satisfaction) %>%
summarize(num=n()) %>%
mutate(percentage=round(num*100/sum(num),2))
```

Personal type of travel passenger is having a third of airline total customer with the number of satisfied customer is only 10% from it. Therefore it is also important customer segment to be improved.

```{r}
data %>% group_by(Customer.Type, Satisfaction) %>%
summarize(num=n()) %>%
mutate(percentage=round(num*100/sum(num),2))
```

76% of first time customer are feels dissatisfied with the airline services, this could be a problem because in the long term it will reducing airlines capability in increasing customer retention.

```{r}
data %>% filter(Customer.Type == 'First-time') %>% group_by(Class ,Satisfaction) %>%
summarize(num=n()) %>%
mutate(percentage=round(num*100/sum(num),2))
```

Most of the first-time customer feel dissatisfied in every class with notably higher in business and economy class.

```{r}
data %>% group_by(Distance_Group) %>%
summarize(num=n()) %>%
mutate(percentage=round(num*100/sum(num),2))
```

Based on the satisfaction rate in each of the distance group, we can notice that as the distance lower the rate of disatisfied customer is increasing. This become a problem because 60% of the airline customer is having journey below 1000.

Next we will try to analyze the service factors related to the customer satisfaction, starting with customer type :

```{r}

# Compute mean for each continuous column
filtered_data <- data %>% filter(Customer.Type == 'First-time') 
filtered_data <- subset(filtered_data, select = -c(ID, Flight.Distance, Age, Arrival.Delay, Departure.Delay, Arrival.Delay.Duration, Arrival.Delay.Duration.log,
                                                   Arrival.Delay.Duration.log.z, Departure.Delay.Duration, Departure.Delay.Duration.log, Departure.Delay.Duration.log.z,
                                                   Flight.Distance.log, Flight.Distance.log.z, Age.log, Age.log.z))

mean_values <- sapply(filtered_data, function(x) if(is.numeric(x)) mean(x, na.rm = TRUE) else NA)
mean_values <- na.omit(mean_values)  

mean_df <- data.frame(Variable = names(mean_values), Mean = mean_values)

# Remove NA values (non-numeric columns)
# Sort in descending order
mean_df <- mean_df[order(mean_df$Mean, decreasing = TRUE), ]

# Plot bar chart with highest value on top and number labels
ggplot(mean_df, aes(x = reorder(Variable, Mean), y = Mean)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_text(aes(label = round(Mean, 2)), hjust = -0.2) +
  coord_flip() +
  theme_minimal() +
  labs(title = "Mean of Continuous Variables", x = "Variable", y = "Mean Value")
```

We can identify that from the first time customer, the services that dissapointing them most in Departure and Arrival Time Convenience, Ease of Online Booking, and Wifi Service.

```{r}

# Compute mean for each continuous column
filtered_data <- data %>% filter(Type.of.Travel == 'Business') 
filtered_data <- subset(filtered_data, select = -c(ID, Flight.Distance, Age, Arrival.Delay, Departure.Delay, Arrival.Delay.Duration, Arrival.Delay.Duration.log,
                                                   Arrival.Delay.Duration.log.z, Departure.Delay.Duration, Departure.Delay.Duration.log, Departure.Delay.Duration.log.z,
                                                   Flight.Distance.log, Flight.Distance.log.z, Age.log, Age.log.z))

mean_values <- sapply(filtered_data, function(x) if(is.numeric(x)) mean(x, na.rm = TRUE) else NA)
mean_values <- na.omit(mean_values)  

mean_df <- data.frame(Variable = names(mean_values), Mean = mean_values)

# Remove NA values (non-numeric columns)
# Sort in descending order
mean_df <- mean_df[order(mean_df$Mean, decreasing = TRUE), ]

# Plot bar chart with highest value on top and number labels
ggplot(mean_df, aes(x = reorder(Variable, Mean), y = Mean)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_text(aes(label = round(Mean, 2)), hjust = -0.2) +
  coord_flip() +
  theme_minimal() +
  labs(title = "Mean of Continuous Variables", x = "Variable", y = "Mean Value")
```

We can identify that from the Personal type of travel customers, the services that dissapointing them most in Departure and Arrival Time Convenience, Ease of Online Booking, and Wifi Service.

```{r}

# Compute mean for each continuous column
filtered_data <- data %>% filter(Class == 'Economy') 
filtered_data <- subset(filtered_data, select = -c(ID, Flight.Distance, Age, Arrival.Delay, Departure.Delay, Arrival.Delay.Duration, Arrival.Delay.Duration.log,
                                                   Arrival.Delay.Duration.log.z, Departure.Delay.Duration, Departure.Delay.Duration.log, Departure.Delay.Duration.log.z,
                                                   Flight.Distance.log, Flight.Distance.log.z, Age.log, Age.log.z))

mean_values <- sapply(filtered_data, function(x) if(is.numeric(x)) mean(x, na.rm = TRUE) else NA)
mean_values <- na.omit(mean_values)  

mean_df <- data.frame(Variable = names(mean_values), Mean = mean_values)

# Remove NA values (non-numeric columns)
# Sort in descending order
mean_df <- mean_df[order(mean_df$Mean, decreasing = TRUE), ]

# Plot bar chart with highest value on top and number labels
ggplot(mean_df, aes(x = reorder(Variable, Mean), y = Mean)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_text(aes(label = round(Mean, 2)), hjust = -0.2) +
  coord_flip() +
  theme_minimal() +
  labs(title = "Mean of Continuous Variables", x = "Variable", y = "Mean Value")
```

We can identify that from the Economy class customers, the services that dissapointing them most in Online Boarding, Ease of Online Booking, and Wifi Service.

### Summary of Initial Plotting 

- 43% of total passengers have liked the airline service. The majority of customers who are satisfied are from business class
- 57% of total passengers are not satisfied. The majority of them are from Economy class
- Only 18% of people have travelled for first time in our airline service. Out of those customers, nearly 76% of customers are not satisfied with our service which could create a chance in future of not returing of customers to our service again. When passengers are coming for first time, most of them have chosen the economy class
- Out of the customers who opted for business class, nearly 69% of customers are satisfied with the business class. Out of the customers who opted for economy class, nearly 81% of them are not satisfied with it. Customers who opted for economy plus class,nearly 75% of them are not satisfied with it.
- Whether people are coming for first time or not and also irrespective of their travel type, they are mostly not satisfied with the Economy and Economy Plus classes. There is strong need for the improvement of Economy class since 45% of total passengers are from economy class. Moreover, 60% of passengers travel less than 10k km and most of them prefer economy class.
- Passengers are not so satisfied with online booking, Online Boarding and the Wifi service mostly.
- 82% of total passengers are returning to the airline service. Out of those 105773 passengers,50% of passengers are from busines class and 42% of passengers are from economy class. Customer who are returning to our service are aged above 30 and make business travel and travel less than 1000 km mostly


## Reflections <a name="2.6"></a>

Lorem Ipsum

# Data Modeling <a name="3"></a>

Lorem Ipsum

## Modeling preparation <a name="3.1"></a>

Lorem Ipsum

## Classification Method <a name="3.2"></a>

Lorem Ipsum

## Logistic Regression <a name="3.3"></a>

Lorem Ipsum
